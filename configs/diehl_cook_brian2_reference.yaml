# Diehl & Cook 2015 Configuration - Brian2 Reference Implementation
# This config closely matches the original Brian2 implementation parameters
# Reference: https://github.com/Hananel-Hazan/bindsnet/blob/master/examples/mnist/diehl_and_cook_2015.py

model:
  name: "DiehlAndCook2015"
  n_neurons: 400          # n_e = 400 (excitatory neurons, matches Brian2)
  n_inpt: 784             # n_input = 784 (28x28 MNIST)
  exc: 22.5               # Excitatory connection strength (Ae->Ae)
  inh: 17.5               # Inhibitory connection strength (Ai->Ae, matches Brian2 default)
  theta_plus: 0.05        # theta_plus_e = 0.05 mV (STDP threshold increment)
  dt: 1.0                 # 1 ms timestep (matches Brian2 default)
  norm: 78.0              # weight['ee_input'] = 78.0 (weight normalization target)
  nu: [0.0001, 0.01]      # [nu_ee_pre, nu_ee_post] = [0.0001, 0.01] (STDP learning rates)
  inpt_shape: [1, 28, 28]
  w_dtype: "float32"
  sparse: true            # Use sparse tensors (more memory efficient)
  inh_thresh: -40.0       # v_thresh_i = -40.0 mV (inhibitory threshold)
  exc_thresh: -72.0       # v_thresh_e = -52.0 mV (excitatory threshold)

training:
  batch_size: 1           # Brian2 runs single examples sequentially
  n_epochs: 1             # Single pass through data
  n_train: 60000          # Full MNIST training set (60k samples)
  n_updates: 6            # update_interval = 10000, so 60000/10000 = 6 updates
  update_interval: 10000  # Update assignments every 10000 samples (matches Brian2)
  time: 350               # single_example_time = 0.35 * second = 350 ms (matches Brian2)
  intensity: 64.0         # input_intensity = 2.0 in Brian2
                          # Brian2: spike_rates = (image / 8.0) * 2.0 = image * 0.25
                          # Max rate = 255 * 0.25 = 63.75 Hz
                          # BindsNET: rate = image * intensity, so intensity â‰ˆ 64.0 to match
  progress_interval: 100 # Print progress every 100 samples (matches Brian2: j % 100 == 0)
  checkpoint_interval: 1
  seed: 0                 # np.random.seed(0) in Brian2
  gpu: true
  
  # Brian2 normalizes weights every sample during training
  enable_monitoring: false      # Disable for speed (Brian2 doesn't always record spikes)
  enable_grad_tracking: false   # STDP doesn't need gradients
  enable_weight_norm: true       # Normalize weights every sample (matches Brian2 normalize_weights() call)

inference:
  batch_size: 1          # Match training batch_size for consistency (was 1 for Brian2 compatibility)
  n_test: 10000           # Full MNIST test set
  time: 350               # Same as training: 350 ms per sample
  intensity: 64.0         # Same intensity as training
  gpu: true
  enable_monitoring: true  # Enable monitoring for analysis

data:
  dataset: "MNIST"
  root: null  # Will use bindsnet default
  n_workers: 1            # Single worker for sequential processing (matches Brian2)

paths:
  checkpoint_dir: "checkpoints"
  model_dir: "models"
  log_dir: "logs"
  data_dir: "data"

